!function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}document.addEventListener("DOMContentLoaded",(function(){fetch("https://ptx.transportdata.tw/MOTC/v2/Rail/Metro/Station/TRTC?$format=xml").then((function(e){return e.text()})).then((function(t){var n=function(t,n){var o={toObj:function(e){var t={};if(1==e.nodeType){if(e.attributes.length)for(var n=0;n<e.attributes.length;n++)t["@"+e.attributes[n].nodeName]=(e.attributes[n].nodeValue||"").toString();if(e.firstChild){for(var i=0,r=0,a=!1,l=e.firstChild;l;l=l.nextSibling)1==l.nodeType?a=!0:3==l.nodeType&&l.nodeValue.match(/[^ \f\n\r\t\v]/)?i++:4==l.nodeType&&r++;if(a)if(i<2&&r<2)for(o.removeWhite(e),l=e.firstChild;l;l=l.nextSibling)3==l.nodeType?t["#text"]=o.escape(l.nodeValue):4==l.nodeType?t["#cdata"]=o.escape(l.nodeValue):t[l.nodeName]?t[l.nodeName]instanceof Array?t[l.nodeName][t[l.nodeName].length]=o.toObj(l):t[l.nodeName]=[t[l.nodeName],o.toObj(l)]:t[l.nodeName]=o.toObj(l);else e.attributes.length?t["#text"]=o.escape(o.innerXml(e)):t=o.escape(o.innerXml(e));else if(i)e.attributes.length?t["#text"]=o.escape(o.innerXml(e)):t=o.escape(o.innerXml(e));else if(r)if(r>1)t=o.escape(o.innerXml(e));else for(l=e.firstChild;l;l=l.nextSibling)t["#cdata"]=o.escape(l.nodeValue)}e.attributes.length||e.firstChild||(t=null)}else 9==e.nodeType?t=o.toObj(e.documentElement):alert("unhandled node type: "+e.nodeType);return t},toJson:function(t,n,i){var r=n?'"'+n+'"':"";if(t instanceof Array){for(var a=0,l=t.length;a<l;a++)t[a]=o.toJson(t[a],"",i+"\t");r+=(n?":[":"[")+(t.length>1?"\n"+i+"\t"+t.join(",\n"+i+"\t")+"\n"+i:t.join(""))+"]"}else if(null==t)r+=(n&&":")+"null";else if("object"==e(t)){var s=[];for(var c in t)s[s.length]=o.toJson(t[c],c,i+"\t");r+=(n?":{":"{")+(s.length>1?"\n"+i+"\t"+s.join(",\n"+i+"\t")+"\n"+i:s.join(""))+"}"}else r+="string"==typeof t?(n&&":")+'"'+t.toString()+'"':(n&&":")+t.toString();return r},innerXml:function(e){var t="";if("innerHTML"in e)t=e.innerHTML;else for(var n=function e(t){var n="";if(1==t.nodeType){n+="<"+t.nodeName;for(var o=0;o<t.attributes.length;o++)n+=" "+t.attributes[o].nodeName+'="'+(t.attributes[o].nodeValue||"").toString()+'"';if(t.firstChild){n+=">";for(var i=t.firstChild;i;i=i.nextSibling)n+=e(i);n+="</"+t.nodeName+">"}else n+="/>"}else 3==t.nodeType?n+=t.nodeValue:4==t.nodeType&&(n+="<![CDATA["+t.nodeValue+"]]>");return n},o=e.firstChild;o;o=o.nextSibling)t+=n(o);return t},escape:function(e){return e.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(e){e.normalize();for(var t=e.firstChild;t;)if(3==t.nodeType)if(t.nodeValue.match(/[^ \f\n\r\t\v]/))t=t.nextSibling;else{var n=t.nextSibling;e.removeChild(t),t=n}else 1==t.nodeType?(o.removeWhite(t),t=t.nextSibling):t=t.nextSibling;return e}};9==t.nodeType&&(t=t.documentElement);var i=o.toJson(o.toObj(o.removeWhite(t)),t.nodeName,"\t");return"{\n"+n+(n?i.replace(/\t/g,n):i.replace(/\t|\n/g,""))+"\n}"}(function(e){var t=null;if(window.DOMParser)try{t=(new DOMParser).parseFromString(e,"text/xml")}catch(e){t=null}else if(window.ActiveXObject)try{(t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(e)||window.alert(t.parseError.reason+t.parseError.srcText)}catch(e){t=null}else alert("oops");return t}(t),""),o=JSON.parse(n).ArrayOfStation.Station;console.log(o);var i=L.map("map").setView([25.03,121.57],13);L.tileLayer("https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'}).addTo(i);var r=L.icon({iconUrl:"https://letswritetw.github.io/letswrite-leaflet-osm-locate/dist/dot.svg",iconSize:[16,16]});Array.prototype.forEach.call(o,(function(e){var t=e.StationPosition.PositionLat,n=e.StationPosition.PositionLon,o=e.StationName.Zh_tw+"站",a=e.StationAddress;L.marker([t,n],{icon:r,title:o}).bindPopup("<b>".concat(o,"</b><br/>").concat(a)).addTo(i)})),L.control.locate({position:"topleft",strings:{title:"定位我的位置",metersUnit:"公尺",feetUnit:"英尺",popup:"距離誤差：{distance}{unit}以內"},clickBehavior:{inView:"setView",outOfView:"setView",inViewNotFollowing:"inView"}}).addTo(i)}))}))}();